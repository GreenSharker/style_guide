<p id="notice"></p>

<div class="view">
  <div class = "col-xs-3 col-sm-1">
    <% @working_article.page.section_pages.each do |page| %>
      <div class = "col-xs-12 col-sm-12">
        <div>
          <a href="<%=  page_path(page) %>"><img width="100%" src="<%= page.jpg_image_path %>"></img>
            <p align =center><%= page.page_number %> </a>
        </div>
      </div>
    <% end %>
  </div>


  <div class = "col-xs-9 col-sm-3">
    <div class="button-group">
      <% if browser.safari? %>
      <%= raw @working_article.page.to_svg %>
      <% elsif browser.modern?  || browser.ie?%>
      <%= raw @working_article.page.to_svg_with_jpg %>
      <% end %>
      <p align =center><%= @working_article.page.page_number %> </a>
    </div>
  </div>

  <div class = "col-xs-12 col-sm-4" style="padding-bottom: 40px;" width="100%">
    <% if @working_article.kind == '사설' || @working_article.kind == 'editorial' %>
      <%= render 'editorial', article: @working_article, page_number:  @working_article.page_number%>
    <% elsif @working_article.kind == '기고' || @working_article.kind == 'opinion' %>
      <%= render 'opinion', article: @working_article %>
    <% else %>
      <%= render 'form', article: @working_article %>
    <% end %>

    <% if @working_article.kind == '기사' %>
      <div class="row" align='center'>
      <% @working_article.images.each do |image| %>
        <div class="col-md-4">
          <p><a href="<%=  edit_image_path(image) %>"><%= image_tag image.image.url(:thumb), :height => "50%", :width=> "100%"%></a></p>
          <p><%= link_to '삭제', image, method: :delete, data: { confirm: 'Are you sure?' } %></p>
        </div>
      <% end %>

      <% if  @working_article.images.length <= 2%>
        <%= form_with( model: @working_article, :html => { :multipart => true }, :url=> {action: 'upload_images'}) do |f| %>
          <%= f.fields_for :images, Image.new do |p| %>
          <br>
          <br>
          <hr>
            <div class="field">
              <%= p.label '사진선택' %><br>
              <p> <%= p.file_field :image, :multiple => true, name: "images[image][]" %></p>
            </div>
          <% end %>
          <div class="actions">
            <%= f.button "사진 올리기", issue: @working_article.issue, class: "btn btn-primary btn-sm", data: {disable_with: "<i class='fa fa-spinner fa-spin'></i> 처리중..."} %>
          </div>
        <% end %>
      <% end %>


      <% # link_to "이미지 추가", add_image_article_path(@working_article), method: :get, class: "btn btn-sm btn-danger" %>
      <% # link_to "저자 이미지 추가", add_personal_image_article_path(@working_article), method: :get, class: "btn btn-sm btn-danger" %>
      <br> 
      <hr>
    </div>
    <% end %>


  </div>


  <!-- <div class = "col-sm-1" style="padding-bottom: 40px;" width="100%">
    <p> </p>
  </div> -->
  <div class="col-xs-12 col-sm-4">
    <% if browser.safari? %>
      <img src="<%= @working_article.pdf_image_path %>" ></img>
    <% elsif browser.modern?  || browser.ie?%>
      <img src="<%= @working_article.jpg_image_path %>" ></img>
    <% end %>

    <% if @working_article.article_info && @working_article.article_info[:overflow_text] && @working_article.article_info[:overflow_text] !=""%>
      <div align="center" ><p>본문 글자수:<%= @working_article.character_count %> | 박스 추가 행: <%= @working_article.extended_line_count %> | 발문 추가: <%= @working_article.quote_box_size %> | 넘친줄 수: <%=  @working_article.article_info[:overflow_line_count] %></p></div>
      <div align="center" style="color:red;"><%=  @working_article.article_info[:overflow_text].html_safe%></div>
    <% elsif @working_article.article_info && @working_article.article_info[:empty_lines] %>
      <p align="center" >본문 글자수:<%= @working_article.character_count %> | 박스 추가 행: <%= @working_article.extended_line_count %>  | 발문 추가: <%= @working_article.quote_box_size %> | 빈줄 수: <%= @working_article.article_info[:empty_lines] %></p>
    <% else %>
      <p align="center" >본문 글자수:<%= @working_article.character_count %> | 박스 추가 행: <%= @working_article.extended_line_count %> | 발문 추가: <%= @working_article.quote_box_size %> </p>
    <% end %>
    <br>
    <br>
</div>
